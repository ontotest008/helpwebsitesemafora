<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
<html> 

<!-- Mirrored from help.semafora-systems.com/explanations.htm by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Oct 2019 09:10:55 GMT -->
<head> 
   <title> Explanations </title> 
   <meta name="generator" content="Help & Manual"> 
   <meta name="keywords" content="Explanations"> 
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 

   <!-- This line forces IE8 into IE7 mode, safer until IE8 is better known -->
   <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />

   <link type="text/css" href="default.css" rel="stylesheet"> 

<!-- non-scrolling headers for CHM and Webhelp--> 
<style type="text/css" media="screen"> 
<!-- 
   body { 
      margin:0; 
      padding:0; 
      overflow: auto; 
      background: #FFFFFF; 
   } 
   #idheader { 
      width:100%; 
      height:auto; 
      padding: 0; 
      margin: 0; 
      background: #FFFFFF; 
   } 

   /* Set the padding in the OUTER div for MSIE and CHM to prevent the 
      width bug and the horizontal scrollbar bug from activating. */ 

  #idcontent {    
      width: 100%; 
      padding: 0px !important; 
      padding: 10px 15px 5px 10px; 
   } 

/* Set the padding in the INNER div for all other browsers. */ 

  #innerdiv {    
      padding: 10px 5px 5px 10px !important;  
      padding: 0px; 
   } 

         /* These styles are for the header, the print link 
         and the navigation links. Change .topichead padding
         to 5px 5px 0px 5px if you use the Print Topic link.  */

    .topichead {
       padding: 5px;
    }
    
    .navlinks {
      font-size: 10pt;
    }
    .navlinks a {
      text-decoration: underline;
      color: black;
    }
    .navlinks a:visited {
      text-decoration: underline;
      color: grey;
    }
    .navlinks a:hover {
      text-decoration: underline;
      color: grey;
    }

    /* These styles are dynamically assigned with Javascript. 
    Since the media type is "screen", they do not apply for print */ 

   html.nonscroll { 
      overflow:hidden; 
   } 
   body.nonscroll {    
      overflow:hidden; 
      height:100%; 
   } 
   div.nonscroll { 
      overflow:auto; 
   } 
   --> 
   </style> 

 <style TYPE="text/css" media="print">
   <!--

     /* Hide navigation links and add space between header and
      text in the printed version. DON'T change this instance for
     adding the Print Topic link, you need the instance further up! */

     #idnav { display:none;	}
     .topichead { padding: 5px 5px 20px 5px; }
   -->
   </style>

<!-- NS-Header and page initialization -->
<script type="text/javascript"> 
<!--
function pageOffset(win)
{
    if(!win) win = window;
    var pos = {left:0,top:0};

    if(typeof win.pageXOffset != 'undefined')
    {
         // Mozilla/Netscape
         pos.left = win.pageXOffset;
         pos.top = win.pageYOffset;
    }
    else
    {
         var obj = (win.document.compatMode && win.document.compatMode == "CSS1Compat") ?
         win.document.documentElement : win.document.body || null;

         pos.left = obj.scrollLeft;
         pos.top = obj.scrollTop;
    }
    return pos;
}

   function doResize() { 
     var clheight, headheight;
     if (self.innerHeight) // all except Explorer 
     { clheight = self.innerHeight; } 
     else if (document.documentElement && document.documentElement.clientHeight) // Explorer 6 Strict Mode 
     { clheight = document.documentElement.clientHeight; } 
     else if (document.body) // other Explorers 
     { clheight = document.body.clientHeight; } 
     headheight = document.getElementById('idheader').clientHeight;
     if (clheight < headheight ) {clheight = headheight + 1;}
     document.getElementById('idcontent').style.height = clheight - document.getElementById('idheader').clientHeight +'px'; 
   } 

      function nsrInit() { 
     contentbody = document.getElementById('idcontent'); 
     if (contentbody) { 
       aTop = pageOffset.top; //document.getElementById('body').scrollTop; 
       contentbody.className = 'nonscroll'; 
       document.getElementsByTagName('body')[0].className = 'nonscroll'; 
       document.getElementsByTagName('html')[0].className = 'nonscroll'; 
       window.onresize = doResize; 
       doResize(); 
       if (contentbody.scrollTo) { contentbody.scrollTo(aTop,0); }
      } 
   } 
-->
   </script> 
<script type="text/javascript" src="helpman_topicinit.js"></script>
<!-- Redirect browser to frame page if page is not in the content frame. -->
<script type="text/javascript">
<!--
if (location.search.lastIndexOf("toc=0")<=0) {
  if (parent.frames.length==0) { parent.location.href="indexb304.html?explanations.htm"; }
  else { parent.quicksync('a3.18'); }
}
//-->
</script>
<script type="text/javascript" src="highlight.js"></script></head> 

<body onload="highlight();">
<div id="hmpopupDiv" style="visibility:hidden; position:absolute; z-index:1000; "></div> 
<div id="idheader"> 
<table width="100%" border="0" cellspacing="0" cellpadding="0"; alink="black">
  
  <tr valign="middle">
    <td width="10px">&nbsp;</td>
    <td align="left"> <span style="font-size: 9pt"> 
     <a href="rule_management.html"><img src="previous.gif" border=0 alt="Previous topic"></a>&nbsp;  
      <a href="about_the_ontoprise_helpsystem.html"><img src="top.gif" border=0 alt="Top" style="padding-top:5px"></a>&nbsp;
     <a href="file_encodings_and_unicode.html"><img src="next.gif" border=0 alt="Next topic"></a>
     <!--IF_TOPIC_BREADCRUMBS>OntoBroker 6.1 > <%TOPIC_HEADER_TEXT%--></span>
    </td>

     <!--td align="left"> <span style="font-size: 9pt"> 
     OntoBroker 6.1 
     <a href="rule_management.htm">rule_management.htm</a>&nbsp;/&nbsp;
     explanations.htm
    </td-->

    <td align="right"> <span style="font-size: 9pt"> 
     
     &nbsp;<a href="javascript: print();"><img src="print.gif" border="0" style="padding-top:5px; padding-right:5px" alt="Print this Topic" title="Print this Topic"></a>
     
     </span>
    </td>
  </tr>
  
  <tr valign="middle" style="padding-top:10px">
    <td width="10px">&nbsp;</td>
    <td width="70%" align="left" style="border-bottom-width:2px; border-bottom-style:solid; border-bottom-color:#CECECE"><p class="p_Heading1"><span class="f_Heading1">Explanations</span></p>
</td>
    <td>&nbsp;</td>
  </tr>



</table>
</div> 

<div id="idcontent"><div id="innerdiv"> 
<p>A feature of OntoBroker is to explain the reason why a query returns specific results. This chapter shows how to enable the explanation feature in OntoBroker and give an example of how to formulate so-called explanation rules.</p>
<p class="p_Heading2"><span class="f_Heading2">Basics</span></p>
<p>Retrieving explanations is done in two steps</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="26"><span style="font-size: 9pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td><span class="f_List">First execute the query with the "explain" query option</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="26"><span style="font-size: 9pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td><span class="f_List">Then execute another query to retrieve the explanations for the first query</span></td></tr></table></div><p>If an explanation for a generated answer is requested, it is necessary that each relevant rule of the ontology is accompanied by an explanation rule. These rules contain text blocks to explain the meaning in common language, including place holders for the concrete instantiations of the rule variables.</p>
<p>Example</p>
<p>We have a ObjectLogic ontology describing people and the company they work in:</p>
<p class="p_CodeExample"><span class="f_CodeExample"> // Concept hierarchy ------------------------------------</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> Company[].</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> Employee[].</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> // Schema -----------------------------------------------</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> Employee[colleague {0:*} *=&gt; Employee].</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> Employee[company {0:*} *=&gt; Company].</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> // Instances --------------------------------------------</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> christian:Employee.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> eva:Employee.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> ibm:Company.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> ontoprise:Company.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> patrick:Employee.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> roman:Employee.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> saartje:Employee.</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> // Properties -------------------------------------------</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> christian[company-&gt;ibm].</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> eva[company-&gt;ontoprise].</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> patrick[company-&gt;ibm].</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> roman[company-&gt;ontoprise].</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> saartje[company-&gt;ontoprise].</span></p>
<p>Additionally we have a rule that states that if two employees work at the same company they are colleagues: </p>
<p class="p_CodeExample"><span class="f_CodeExample">@{ruleColleague} </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">?A[colleague-&gt;?D] :- ?A:Employee AND ?A[company-&gt;?F] AND ?D:Employee AND ?D[company-&gt;?F] AND ?F:Company AND NOT _unify(?A,?D).</span></p>
<p>You can pose the following query to ask for people and their colleagues:</p>
<p class="p_CodeExample"><span class="f_CodeExample">@{queryColleague, options[outorder(?Employee2,?Employee1)]} </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">?- ?Employee2:Employee and ?Employee1:Employee[colleague-&gt;?Employee2].</span></p>
<p>This will return the following results:</p>
<p><img src="explanation_query.png" width="776" height="536" border="0" alt="explanation_query"></p>
<p>Now you might want to explain why two people (represented by the variables denoted by $A$ and $D$) are colleagues.</p>
<p class="p_CodeExample"><span class="f_CodeExample"> $A$ and $D$ are colleagues because they are both employees of the company $F$</span></p>
<p>This would be expressed in the ObjectLogic rule</p>
<p class="p_CodeExample"><span class="f_CodeExample"> @{ruleColleague_EXPLANATION} </span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> _explain(?QK,?I,?S) :-</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> &nbsp; (?I:&lt;obl:default:Instantiation&gt;[&lt;obl:default:ruleid&gt; -&gt; ruleColleague],</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> &nbsp; &nbsp;?I[&lt;obl:default:variables&gt; -&gt; &lt;obl:default:i&gt;(&lt;obl:default:A&gt;,?var_A)],</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> &nbsp; &nbsp;?I[&lt;obl:default:variables&gt; -&gt; &lt;obl:default:i&gt;(&lt;obl:default:D&gt;,?var_D)],</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> &nbsp; &nbsp;?I[&lt;obl:default:variables&gt; -&gt; &lt;obl:default:i&gt;(&lt;obl:default:F&gt;,?var_F)],</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> &nbsp; &nbsp;_applyStringTemplate("$A$ and $D$ are colleagues because they are both employees of the company $F$",[], [&lt;obl:default:A&gt;(?var_A),&lt;obl:default:D&gt;(?var_D),&lt;obl:default:F&gt;(?var_F)],?S))@$prooftreefacts(?QK).</span></p>
<p>Note that OntoBroker allows explanation rules to be generated automatically, so you do not have to write this rule manually (see below for details). Querying for all employees and their colleagues would be done in the following way:</p>
<p class="p_CodeExample"><span class="f_CodeExample"> ?- ?Employee2:Employee and ?Employee1:Employee[colleague-&gt;?Employee2].</span></p>
<p>If result explanations are required, this is done using an additional annotation:</p>
<p class="p_CodeExample"><span class="f_CodeExample"> @{options[explain]} ?- ?Employee2:Employee and ?Employee1:Employee[colleague-&gt;?Employee2].</span></p>
<p>This will bring the same results as before but will internally create a new module for the query session. The module contains the information needed to create the explanations. They can be queried in the following way:</p>
<p class="p_CodeExample"><span class="f_CodeExample"> ?- _explain(?QK, ?RID, ?S).</span></p>
<p>Where:</p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="26"><span style="font-size: 9pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td><span class="f_List">?QK: is a variable representing the query session</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="26"><span style="font-size: 9pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td><span class="f_List">?RID: is the result id</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="26"><span style="font-size: 9pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td><span class="f_List">?S: is the textual representation of the explanation</span></td></tr></table></div><p>This will actually bring the result:</p>
<p><img src="explanation_results.png" width="771" height="538" border="0" alt="explanation_results"></p>
<p>for this ontology.</p>
<p><span class="f_Heading2">Generating Explanation Rules</span></p>
<p>OntoBroker provides a built-in for automatically generating explanation templates. Assume you want to generate an explanation rule for the following rule:</p>
<p class="p_CodeExample"><span class="f_CodeExample">@{R1}</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">?- &nbsp; &nbsp;  </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">aPerson1[hatKind-&gt;aPerson3]</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">:- </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">aPerson1:Person AND </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">aPerson2:"Person AND </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">aPerson3:"Person AND </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">aPerson1[hasChildWith(aPerson2)-&gt;aPerson3].</span></p>
<p>First of all you can use the built-in _generateExplanationTemplate/4 to generate the default explanation template: </p>
<p class="p_CodeExample"><span class="f_CodeExample">?- _generateExplanationTemplate("m1","R1","",?OUT).</span></p>
<p class="p_Heading2"><span class="f_Heading2">Generated template </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">'$aPerson1$ hatKind $aPerson3$</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">BECAUSE</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson1$ is a Person AND </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson2$ is a Person AND </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson3$ is a Person AND </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson1$ ns_(#,hasChildWith($aPerson2$)) $aPerson3$'</span></p>
<p>Typically you will edit this template to abstract from the rule details and focus on the statement of the rule. With the final template you can then use the built-in _generateExplanationRuleText/4 to generate the rule text of the explanation rule: </p>
<p class="p_CodeExample"><span class="f_CodeExample">?- _generateExplanationRuleText("m1","r1","""$aPerson1$ hatKind $aPerson3$</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">BECAUSE</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson1$ is a Person AND </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson2$ is a Person AND </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson3$ is a Person AND </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson1$ ns_(#,hasChildWith($aPerson2$)) $aPerson3$""",?OUT).</span></p>
<p class="p_Heading2"><span class="f_Heading2">Generated explanation rule </span></p>
<p class="p_CodeExample"><span class="f_CodeExample">explain_(QK,I,S) &lt;-</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> &nbsp; &nbsp;I:Instantiation[ruleid-&gt;R1]@prooftreefacts_(QK)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> &nbsp; &nbsp;AND I[variables-&gt;i(aPerson1,var_aPerson1)]@prooftreefacts_(QK)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> &nbsp; &nbsp;AND I[variables-&gt;i(aPerson3,var_aPerson3)]@prooftreefacts_(QK)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> &nbsp; &nbsp;AND I[variables-&gt;i(aPerson2,var_aPerson2)]@prooftreefacts_(QK)</span></p>
<p class="p_CodeExample"><span class="f_CodeExample"> &nbsp; &nbsp;AND _applyStringTemplate(\'$aPerson1$ hatKind $aPerson3$</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">BECAUSE</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson1$ is a Person AND</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson2$ is a Person AND</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson3$ is a Person AND</span></p>
<p class="p_CodeExample"><span class="f_CodeExample">$aPerson1$ ns_(#,hasChildWith($aPerson2$))</span></p>
<p class="p_CodeExample"><span style="width:48px">&nbsp;</span><span class="f_CodeExample">$aPerson3$\',[],[aPerson1(var_aPerson1),aPerson3(var_aPerson3),aPerson2(var_aPerson</span></p>
<p class="p_CodeExample"><span style="width:48px">&nbsp;</span><span class="f_CodeExample">2)],S)@prooftreefacts_(QK).'</span></p>
<p>&nbsp;</p>
<p style="margin: 0px 0px 0px 0px;"><span style="font-size: 10pt; font-family: 'Arial';">NOTE: </span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="26"><span style="font-size: 9pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td><span class="f_List" style="font-weight: bold;">Querykey</span><span class="f_List">: As the OntoBroker runs as a server there may be several queries at a time. To be able to identify the requested explanation, each query is uniquely identified by a key. This key allows the explanation for the query to be accessed. The querykey is accessible via the API of the QueryClient (please see the JavaDocs for further informations). </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="26"><span style="font-size: 9pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td><span class="f_List" style="font-weight: bold;">Caching</span><span class="f_List">: When the explanation feature is used, each executed query generates explanation information stored at the server. To prevent the system running out of memory it is necessary to remove the generated explanation using the removeExplanation command. This command takes the querykey as an argument and will tell the server to clean up all information related to the explanation of this concrete query. </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 5px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="line-height: normal;"><tr style="vertical-align:baseline" valign="baseline"><td width="26"><span style="font-size: 9pt; font-family: 'Arial Unicode MS', 'Lucida Sans Unicode', 'Arial'; color: #000000;">&#8226;</span></td><td><span class="f_List" style="font-weight: bold;">Explanations</span><span class="f_List">: OntoStudio provides an graphical user interface for dealing with explanations.</span></td></tr></table></div> 
</div></div> 

<script type="text/javascript"> 
<!-- 
var lastSlashPos = document.URL.lastIndexOf("index.html") >
document.URL.lastIndexOf("\\") ? document.URL.lastIndexOf("index.html") :
document.URL.lastIndexOf("\\");
if( document.URL.substring( lastSlashPos + 1, lastSlashPos + 4).toLowerCase() != "~hh" )
{
    nsrInit();
}
--> 
</script> 
</body> 

<!-- Mirrored from help.semafora-systems.com/explanations.htm by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 01 Oct 2019 09:10:56 GMT -->
</html>
